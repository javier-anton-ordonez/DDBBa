# ============================================
# Configuración de RÉPLICA 1
# ============================================

[mysqld]
# --- Identificación del servidor (ÚNICO) ---
server_id = 2

# --- Réplica en modo solo lectura ---
read_only = ON
super_read_only = ON                   # Ni siquiera root puede escribir

# --- Relay log ---
relay_log = relay-bin
relay_log_purge = ON                   # Limpiar relay logs aplicados

# --- GTID (debe coincidir con primario) ---
gtid_mode = ON
enforce_gtid_consistency = ON

# --- Binary log (útil si esta réplica se promociona a primario) ---
log_bin = mysql-bin
binlog_format = ROW
log_replica_updates = ON               # Escribir cambios replicados al binlog

# --- InnoDB Tunning ---
innodb_buffer_pool_size = 256M
innodb_log_file_size = 64M
innodb_flush_log_at_trx_commit = 2     # Menos estricto en réplica (mejor rendimiento)
innodb_flush_method = O_DIRECT

# --- Conexiones ---
max_connections = 200

# --- Validación ---
sql_mode = STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION

# --- Logs ---
log_error_verbosity = 3
slow_query_log = 1
long_query_time = 1

# --- Character set ---
character_set_server = utf8mb4
collation_server = utf8mb4_0900_ai_ci
